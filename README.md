# Proses Spark Data dari dataset balita berdasarkan jenis kelamin di Provinsi Jawa Barat, Indonesia menggunakan Python.
Pada kali ini akan dilakukan proses _Spark Data_ pada dataset jumlah balita umur 12-59 bulan berdasarkan jenis kelamin di Provinsi JawaBarat yang mana data tersebut diambil dari website opendata.jabarprov.go.id.
## Data Extraction
Pada tahap ini digunakan library ‘pyspark’, memasukan modul ‘pandas’ untuk menganalisis dan memanipulasi data, modul ‘matplotlib.pyplot’ untuk membuat visualisasi grafik, modul ‘request’ untuk melakukan permintaan HTTP, modul ‘pyspark.sql’ untuk mengakses ‘SparkSession’ yang digunakanuntuk mengakses fungsionalitas Apache Spark, memasukan beberapa tipe data yang diperlukan untuk mendefinisikan skema DataFrame dalam Apache Spark, dan memasukan fungsi agregasi yang digunakan dalam operasi DataFrame Apache Spark.
Selanjutnya, membuat sesi Spark dengan nama “Analisis Jumlah Balita Jabar” menggunakan “SparkSession” dan menyimpan dalam variabel ‘spark’. Setelah itu mengirim HTTP GET ke URL yang diberikan untuk menyimpan responsenya ke dalam variabel ‘response’ menggunakan modul ‘request’. Untukmengambil data dari respons API dalam format JSON dan menyimpan dalam variabel ‘data’ dapat digunakan ``` response.json()[“data”]```, lalu nilai ‘data’ dapat dicetak ke output konsol menggunakan 
```‘print(data)’```. Setelah itu dengan ``` ‘spark.createDataFrame(data)``` digunakan untuk mengonversidata ‘spark’ yang telah diambil dari API menjadi sebuah DataFrame yang berfungsi untuk melakukan berbagai operasi analisis data, seperti pemfilteran, pengelompokan, maupun perhitungan agregat dengan menggunakan ApacheSpark. Setelah DataFrame dibuat, metode ‘show’ digunakan untuk membantu dalam melihat dan memverifikasi data yang telah diambil dan diubah menjadi DataFrame. 
## Data Analisis dengan _Spark SQL_
Sebelum melakukan analisis, dilakukan penggantian nama tampilan sementara dari DataFrame menjadi ‘data_balita’ sebagai tabel dalam query SQL di PySpark.
### Hubungan Jumlah Balita dengan Tahun
Untuk melihat hubungan jumlah balita setiap tahunnya, dalam melakukan analisis data digunakan ```spark.sql()``` agar dapat menjalankan “data_balita”. Selanjutnya, dengan melakukan grouping pada tahun balita da menjumlahkan balita yang ada pada setiap tahunnya maka query tersebut akan mengambil kolom “tahun” dan menjumlahkan “jumlah_balita” berdasarkan tahun. Dalam analisis ini query SQL akan menghitung jumlah balita berdasarkan tahun dan akan menghasilkan dua kolom yaitu kolom hasil “tahun” dan “jumlah_balita”.
### Perbandingan Jumlah Balita Laki-laki dan Perempuan
untuk melihat jumlah perbandingan balita laki-laki dan balita perempuan dengan umur
12-59 bulan yang ada di Provinsi Jawa Barat kami menggunakan ``` spark.sql ``` untuk menjalankan “data_balita”. Lalu dengan memilih kolom jenis_kelamin, menjumlahkan kolom jumlah_balita dan mengganti namanya menjadi Jumlah_Balita serta melakukan grouping data jenis_kelamin maka akan menghasilkan dua kolom yaitu “jenis_kelamin” dan “Jumlah_Balita” 
### Top 10 Kabupaten/ Kota dengan Jumlah Balita Terbanyak dan Paling Sedikit
Untuk mengetahui Top 10 Kabupaten/Kota dengan jumlah balita terbanyak dan paling sedikit dapat digunakan ``` spark.sql ```. Untuk ‘result 3’ digunakan ``` spark.sql ``` tersebut untuk melakukan query terhadap ‘data_balita’ menggunakan Apache Spark SQL. Query ini akan mengambil kolom ‘nama_kabupaten_kota’ dan menjumlahkan kolom ‘jumlah_balita’ pada setiap kabupaten/kota. Data tersebut kemudian dikelompokan berdasarkan ‘nama_kabupaten_kota’, diurutkan berdasarkan ‘jumlah_balita’ dari yang terbesar hingga yang terkecil, dan dibatasi hanya untuk 10 teratas.

Setelah itu, data query tersebut diubah menjadi Pandas DataFramedengan bantuan ``` toPandas( ) ``` agar dapat digunakan dalam visualisasi. Data tersebut kemudian digambarkan dalam bentuk bar chart menggunakan ``` plot( ) ``` dengan sumbu x sebagai ‘nama_kabupaten_kota’
dan sumbu y sebagai ‘Jumlah’. Bar char ini akan menunjukan 10 kabupaten/kota dengan jumlah balita terbanyak di Jawa Barat. Grafik akan ditampilkan dengan label sumbu x sebagai “Jumlah Balita”, label sumbu y sebagai “Kabupaten/Kota”, dan grafik diberi judul "Top 10 Kabupaten/Kota di Jawa Barat dengan Jumlah Balita Terbanyak".

Untuk ‘result4’ hampir sama dengan sebelumnya, namun untuk hasil querynya akan diurutkan dari yang terkecil hingga yang terbesar berdasarkan ‘jumlah_balita’. Tujuannya untuk mendapatkan 10 kabupaten/kota dengan jumlah balita paling sedikit di Jawa Barat. Setelah itu, data hasil query diubah menjadi Pandas DataFrame dan digambakan dalam bentuk bar chart yang serupa dengan syntax sebelumnya. Grafik pada kali ini akan menunjukkan 10 kabupaten/kota dengan jumlah balita paling sedikit di Jawa Barat sehingga judul grafik tersebut "Top 10 Kabupaten / Kota di Jawa Barat dengan Jumlah Balita Paling Sedikit" dengan varibel x dan y yang sama seperti sebelumnya.

Untuk ‘result34’ dilakukan query terhadap ‘data_balita’ menggunakan Apache Spark SQL juga. Perbedaannya query pada kali ini akan mengambil kolom ‘nama_kabupaten_kota’ dan melakukan aggregasi pada ‘jumlah_balita’ dengan kondisi bahwa jika ‘jenis_kelamin’ adalah ‘LAKI-LAKI’, maka ‘jumlah_balita’ akan dijumlahkan, begitu pula jika 'jenis_kelamin’ adalah ‘PEREMPUAN’, namun jika ‘jenis_kelamin’ tidak memenuhi keduanya, maka ‘jumlah_balita’ akan diambil sebagai 0. Hasilnya akan disimpan sebagai kolom baru dengan alias ‘Jumlah_LakiLaki’ dan ‘Jumlah_Perempuan’. Selain itu, dilakukan juga perhitungan selisih antara jumlah balita laki-laki dan perempuan. Data tersebut kemudian dikelompokkan berdasarkan ‘nama_kabupaten_kota’ dan diurutkan dari yang terbesar hingga terkecil berdasarkan ‘Jumlah_LakiLaki’.

Terakhir, untuk ‘result5’ dilakukan seperti sebelumnya namun query pada kali ini kolom ‘nama_kabupaten_kota’ dan aggregasi pada ‘jumlah_balita’ berdasarkan tahun tertentu. Jumlah balita untuk tahun 2019 akan dijumlahkan sebagai ‘Tahun_2019’, jumlah balita untuk tahun 2020 akan dijumlahkan sebagai ‘Tahun_2020’. Selain itu, juga dilakukan perhitungan persentase perubahan antara jumlah balita tahun 2020 dan tahun 2019. Persentase perubahan dihitung dengan mengurangi jumlah balita tahun 2019 dari jumlah balita tahun 2020, kemudian membaginya dengan jumlah balita tahun 2019, dan hasilnya dikalikan 100. Data hasil query ini dikelompokkan berdasarkan ‘nama_kabupaten_kota’. Data-data hasil query tersebut dapat ditampilkan dengan menggunakan ``` show( ) ```.
